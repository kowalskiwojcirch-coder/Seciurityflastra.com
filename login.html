<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Login | Security Flastra</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="logo">Securityflastra.com</div>
  <ul class="nav-links">
    <li><a href="index.html">Home Page</a></li>
    <li><a href="secretary.html">Secretary</a></li>
    <li><a href="login.html">Login</a></li>
    <li class="search">ğŸ”</li>
  </ul>
</nav>

<section class="login-section">
  <!-- PROFIL ZALOGOWANEGO UÅ»YTKOWNIKA -->
  <div id="profilePanel" class="profile-panel" style="display: none;">
    <div class="profile-card">
      <div class="profile-avatar">ğŸ‘¤</div>
      <h2 id="profileName"></h2>
      <p id="profileEmail"></p>
      <button id="logoutBtn" class="logout-btn">Wyloguj siÄ™</button>
    </div>
  </div>

  <!-- LOGOWANIE -->
  <div id="loginDiv" class="login-container">
    <h1>Logowanie</h1>
    <input type="text" id="loginEmail" placeholder="Email lub nazwa" required>
    <input type="password" id="loginPass" placeholder="HasÅ‚o" required>
    <button id="loginBtn">Zaloguj siÄ™</button>
    <p>Nie masz konta? <button id="toRegister" style="background: none; border: none; color: #4da3ff; cursor: pointer; text-decoration: underline; padding: 0;">Rejestracja</button></p>
    <div id="loginError" class="error-message" style="display: none;"></div>
  </div>

  <!-- REJESTRACJA -->
  <div id="registerDiv" class="login-container" style="display: none;">
    <h1>Rejestracja</h1>
    <input type="text" id="regUsername" placeholder="Nazwa uÅ¼ytkownika" required>
    <input type="text" id="regEmail" placeholder="Email" required>
    <input type="password" id="regPass" placeholder="HasÅ‚o" required>
    <input type="password" id="regPassConf" placeholder="PotwierdÅº hasÅ‚o" required>
    <div class="checkbox-group">
      <input type="checkbox" id="privacyCheck" required>
      <label for="privacyCheck">AkceptujÄ™ <strong>politykÄ™ prywatnoÅ›ci</strong> i <strong>pliki cookies</strong></label>
    </div>
    <button id="registerBtn">Zarejestruj siÄ™</button>
    <p>Masz juÅ¼ konto? <button id="toLogin" style="background: none; border: none; color: #4da3ff; cursor: pointer; text-decoration: underline; padding: 0;">Logowanie</button></p>
    <div id="regError" class="error-message" style="display: none;"></div>
  </div>
</section>

<footer>
  <p>&copy; 2024-2026 Security Flastra. Wszystkie prawa zastrzeÅ¼one.</p>
</footer>

<script>
let userData = JSON.parse(localStorage.getItem('appUsers')) || {};

// PRZEÅÄ„CZANIE MIÄ˜DZY FORMULARZAMI
document.getElementById('toRegister').onclick = function(e) {
  e.preventDefault();
  document.getElementById('loginDiv').style.display = 'none';
  document.getElementById('registerDiv').style.display = 'block';
};

document.getElementById('toLogin').onclick = function(e) {
  e.preventDefault();
  document.getElementById('registerDiv').style.display = 'none';
  document.getElementById('loginDiv').style.display = 'block';
};

// REJESTRACJA
document.getElementById('registerBtn').onclick = function() {
  const username = document.getElementById('regUsername').value.trim();
  const email = document.getElementById('regEmail').value.trim();
  const pass = document.getElementById('regPass').value;
  const passConf = document.getElementById('regPassConf').value;
  const privacyOk = document.getElementById('privacyCheck').checked;
  const errDiv = document.getElementById('regError');
  
  errDiv.style.display = 'none';
  
  if (!privacyOk) {
    errDiv.innerHTML = 'âŒ Musisz zaakceptowaÄ‡ politykÄ™ prywatnoÅ›ci!';
    errDiv.style.display = 'block';
    return false;
  }
  
  if (pass !== passConf) {
    errDiv.innerHTML = 'âŒ HasÅ‚a siÄ™ nie zgadzajÄ…!';
    errDiv.style.display = 'block';
    return false;
  }
  
  if (pass.length < 6) {
    errDiv.innerHTML = 'âŒ HasÅ‚o musi mieÄ‡ co najmniej 6 znakÃ³w!';
    errDiv.style.display = 'block';
    return false;
  }
  
  if (userData[email]) {
    errDiv.innerHTML = 'âŒ Ten email juÅ¼ istnieje!';
    errDiv.style.display = 'block';
    return false;
  }
  
  userData[email] = { username: username, email: email, password: pass };
  localStorage.setItem('appUsers', JSON.stringify(userData));
  localStorage.setItem('loggedUser', email);
  
  // WyczyÅ›Ä‡ pola formularza
  document.getElementById('regUsername').value = '';
  document.getElementById('regEmail').value = '';
  document.getElementById('regPass').value = '';
  document.getElementById('regPassConf').value = '';
  document.getElementById('privacyCheck').checked = false;
  
  showProfile(userData[email]);
};

// LOGOWANIE
document.getElementById('loginBtn').onclick = function() {
  const input = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPass').value;
  const errDiv = document.getElementById('loginError');
  
  errDiv.style.display = 'none';
  
  let foundUser = null;
  for (let key in userData) {
    const user = userData[key];
    if ((user.email === input || user.username === input) && user.password === pass) {
      foundUser = user;
      break;
    }
  }
  
  if (foundUser) {
    localStorage.setItem('loggedUser', foundUser.email);
    showProfile(foundUser);
  } else {
    errDiv.innerHTML = 'âŒ BÅ‚Ä™dny email/nazwa lub hasÅ‚o!';
    errDiv.style.display = 'block';
  }
};

// WYLOGOWANIE
document.getElementById('logoutBtn').onclick = function() {
  localStorage.removeItem('loggedUser');
  document.getElementById('profilePanel').style.display = 'none';
  document.getElementById('loginDiv').style.display = 'block';
  document.getElementById('registerDiv').style.display = 'none';
  document.getElementById('loginEmail').value = '';
  document.getElementById('loginPass').value = '';
};

// POKAÅ» PROFIL
function showProfile(user) {
  document.getElementById('loginDiv').style.display = 'none';
  document.getElementById('registerDiv').style.display = 'none';
  document.getElementById('profilePanel').style.display = 'block';
  document.getElementById('profileName').textContent = user.username;
  document.getElementById('profileEmail').textContent = user.email;
}

// SPRAWDÅ¹ CZY JUÅ» ZALOGOWANY
window.onload = function() {
  const logged = localStorage.getItem('loggedUser');
  if (logged && userData[logged]) {
    showProfile(userData[logged]);
  }
};
</script>

</body>
</html>
